#!/usr/bin/env bash
#

generateFormula () {
  local suffix="$1"
  local version="$2"
  local sha="$3"
  local dir="$(mktemp -dt brew)"
  local formula="$dir/scala$suffix.rb"
  local content="$(cat <<EOM
require 'formula'

class Scala$suffix < Formula
  homepage  'http://www.scala-lang.org/'
  url       "http://www.scala-lang.org/files/archive/scala-$version.tgz"
  sha256    '$sha'
  version   '$version'

  def install
    rm_f Dir["bin/*.bat"]
    libexec.install Dir['*']
    ['scala', 'scalac'].each do |cmd|
      renamed = "#{libexec}/bin/#{cmd}$suffix"
      ln_s "#{libexec}/bin/#{cmd}", renamed
      bin.install_symlink renamed
    end
  end
end
EOM
)"

  printf "%s\n" "$content" > "$formula"
  brew install "$formula"
}

generateFormula 29   2.9.3 faaab229f78c945063e8fd31c045bc797c731194296d7a4f49863fd87fc4e7b9
generateFormula 210 2.10.6 54adf583dae6734d66328cafa26d9fa03b8c4cf607e27b9f3915f96e9bcd2d67

#generateFormula 211 2.11.7 ffe4196f13ee98a66cf54baffb0940d29432b2bd820bd0781a8316eec22926d0

generateFormula 212 2.12.0-M3 67ee3394ff5f9a98f9579accc9e20e0c9911d6f0bce96d70cf63cbb676643802
